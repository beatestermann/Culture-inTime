<h1 class="ui header">
  <%= @data_source.name %>
</h1>
<div class="ui divider"></div>

<p>
  <div class="ui labeled button" tabindex="0">
    <div class="ui tertiary button">
      <i class="user icon"></i> Author
    </div>
    <div class="ui basic tertiary left pointing label"><%= @data_source.email %></div>
  </div>

  <%  if @data_source.layers.count == 0 %>
    <div class="ui labeled button" tabindex="0">
      <div class="ui tertiary button">
        <i class="calendar icon"></i> Cached on
      </div>
    
      <div class="ui basic tertiary left pointing label"><%= @data_source.loaded %></div>
    </div>

    <% button_label =  @data_source.loaded.blank? ? 'Execute SPARQL' : 'Refresh cache' %>
    <%= link_to button_label, load_data_source_path, class: "ui button primary show_loading" %>
    <%= link_to "Load RDF", load_rdf_data_source_path, class: "ui button primary show_loading" %>
    <% if @data_source.loaded.present? %>
    <%= link_to 'View all', search_path(data_source:@data_source.id), class: "ui button tertiary" %>
    <% end %>

  <% else %>
    Chained to layers: <%= @data_source.layers.map {|l| l.name }.join(", ") %>
  <% end %>


</p>
<p id="notice">
  <% if notice %>
  <div class="ui info message">
    <div class="header">
      <%= notice %>
    </div>

  </div>
  <% end %>
</p>


<% if  @sample_graph  %>
<script>
$('.ui.accordion')
  .accordion()
;
</script>
<div class="ui styled accordion">
  <div class="title">
    <i class="dropdown icon"></i>
    What is a dog?
  </div>
  <div class="content">
    <p class="transition hidden">A dog is a type of domesticated animal. Known for its loyalty and faithfulness, it can be found as a welcome guest in many households across the world.</p>
  </div>
</div>

<pre>
 <code>
 Sample JSON-LD for <%= @sample_uri %><br>
  <%= @sample_graph %>
</code>
</pre>
 <% end %>

<pre>
 <code>
  <%= @data_source.sparql %>
</code>
</pre>

<% if cookies[:user] == @data_source.email || is_admin? %>
<%= link_to 'Edit', edit_data_source_path(@data_source), class: "ui button green" %>
<% end %>
<%= link_to 'Back', data_sources_path, class: "ui button black" %>